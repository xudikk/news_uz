{% extends 'dashboard/base.html' %}

{% load widget_tweaks %}

{% block content %}


{% if position == 'form' %}
            <div class="card">
              <div class="card-header d-flex justify-content-between">
                 <div class="header-title">
                    <h4 class="card-title">Yangilik Qo'shish</h4>
                 </div>


              </div>

              <div class="card-body">
                 <div class="table-editable">
                     <form enctype="multipart/form-data" method="post">
                         {% csrf_token %}

                           <div class="form-row">


                              <div class="col-md-4 mb-3">
                                 <label >Yangilikning Sarlavhasi</label>
                                  {{ form.title|add_class:'form-control' }}
                              </div>
                              <div class="col-md-4 mb-3">
                                 <label >Yangilikning Categoriya</label>
                                  {{ form.ctg|add_class:'form-control' }}
                              </div>
                              <div class="col-md-4 mb-3">
                                 <label >Yangilik uchun Teglar(probel bn yozing)</label>
                                  {{ form.tags|add_class:'form-control' }}
                              </div>
                               <div class="col-md-6 mb-3">
                                <label>Qisqacha tasnif</label>
                                  {{ form.short_desc|add_class:'form-control' }}
                               </div>
                               <div class="col-md-6 mb-3">
                                <label>To'liq matn</label>
                                  {{ form.description|add_class:'form-control' }}
                               </div>

                               <div class="col-md-6 mb-3">
                                  <p>Birinchi rasm: {{ obj.image1 }}</p>
                                   <div class="custom-file mb-3">
                                      <input type="file" value="{{ obj.image1 }}" class="custom-file-input" id="customFile1" name="image1" required>
                                      <label class="custom-file-label" for="customFile1">Choose file</label>
                                   </div>
                               </div>

                               <div class="col-md-6 mb-3">
                                  <p>Ikkinchi rasm:  {{ obj.image2 }}</p>
                                   <div class="custom-file mb-3">
                                      <input type="file" value="{{ obj.image2 }}" class="custom-file-input" id="customFile2" name="image2">
                                      <label class="custom-file-label" for="customFile2">Choose file</label>
                                   </div>
                               </div>
                           </div>

                           <div class="form-group">
                              <button class="btn btn-primary" type="submit">Submit form</button>
                           </div>
                        </form>
                 </div>

                 <hr>

              </div>

           </div>






{% elif position == 'list' %}
        <div class="card">
              <div class="card-header d-flex justify-content-between">
                 <div class="header-title">
                    <h4 class="card-title">Yangiliklar Ro'yxati</h4>
                 </div>


              </div>

              <div class="card-body">

                  {% if success %}
                  <div class="alert alert-success" role="alert">
                       <div class="iq-alert-text">{{ success }}</div>
                 </div>
                  {% endif %}
                    {% if error %}
                  <div class="alert alert-danger" role="alert">
                       <div class="iq-alert-text">{{ error }}</div>
                 </div>
                  {% endif %}

                 <div class="table-editable">
                    <span class="float-right mb-3 mr-2">
                    <a href="{% url 'news-add' %}" class="btn btn-sm bg-primary">
                        <span>Yangi Qo'shish</span>
                    </a>
                    </span>
                    <table class="table table-bordered table-responsive-md table-striped text-center">
                       <thead>
                          <tr>
                             <th>ID</th>
                             <th>Title</th>
                             <th>Categoriya</th>
                             <th>Ko'rishlar soni</th>
                             <th>Rasm</th>

                             <th>Actions</th>
                          </tr>
                       </thead>
                       <tbody>

                       {% for i in news %}
                          <tr>
                             <td>{{ i.id }}</td>
                             <td style="max-width: 200px;"><b>{{ i.title }}</b></td>
                             <td>{{ i.ctg.name }}</td>
                             <td>{{ i.views }}</td>
                             <td>
                                 <img src="{{ i.image1.url }}" alt=""
                                 style="max-width: 150px; max-height: 150px;">

                             </td>


                             <td>

                                <a href="{% url 'news-detail' pk=i.id %}" class="btn btn-outline-primary rounded-pill btn-sm">
                                   <i class="fas fa-book">
                                   </i>
                                </a>
                                <a href="{% url 'news-edit' pk=i.id %}" class="btn btn-outline-success rounded-pill btn-sm">
                                   <i class="fas fa-pencil">
                                   </i>
                                </a>
                                <button class="btn btn-outline-danger rounded-pill btn-sm" data-toggle="modal" data-target="#deleteModal-{{ i.id }}" >
                                   <i class="fas fa-trash">
                                   </i>
                                </button>


                             </td>

                          </tr>
                       {% endfor %}

                       </tbody>
                    </table>
                 </div>

                 <hr>

               <nav aria-label="...">

                  <ul class="pagination justify-content-start">


                   {% if news.has_previous %}
                     <li class="page-item ">
                        <a class="page-link" href="?page={{ news.previous_page_number }}" tabindex="-1" aria-disabled="true"><<</a>
                     </li>
                     {% endif %}


                     {% for i in paginator.page_range %}
                     {% if i == page %}

                     <li class="page-item active" aria-current="page">
                        <a class="page-link">{{ i }} <span class="sr-only">(current)</span></a>
                     </li>
                     {% else %}
                        <li class="page-item"><a class="page-link" href="?page={{ i }}">{{ i }}</a></li>
                     {% endif %}
                     {% endfor %}


                     {% if news.has_next %}
                     <li class="page-item">

                        <a class="page-link" href="?page={{ news.next_page_number }}"> >> </a>
                     </li>
                        {% endif %}


                  </ul>

               </nav>


              </div>

           </div>


<!--  ***************  delete modal *************** -->
    {% for i in news %}
    <div class="modal fade" id="deleteModal-{{ i.id }}" tabindex="-1" role="dialog" aria-labelledby="LogoutModalTitle" aria-hidden="true">
       <div class="modal-dialog modal-dialog-centered" role="document">
          <div class="modal-content">
             <div class="modal-header">
                <h5 class="modal-title" id="deleteModalTitle">Modal title</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                <span aria-hidden="true">&times;</span>
                </button>
             </div>
             <div class="modal-body">
                Rostdan Ham <mark>{{ i.title }}</mark>ni o'chirmochimisz?
             </div>
             <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal">Yo'q</button>
                <a href="{% url 'news-delete' pk=i.id %}" type="button" class="btn btn-primary">Ha</a>
             </div>
          </div>
       </div>
    </div>
    {% endfor %}



{% elif position == 'detail' %}


<div class="card">
      <div class="card-header d-flex justify-content-between">
         <div class="header-title">
            <h4 class="card-title"><mark class="bg-secondary">{{ new.title }}</mark></h4>
         </div>

      </div>

      <div class="card-body">
          <div class="col-lg-12 col-md-12">
         <div class="row">
            <div class="col-md-4">
               <div class="card">
                  <div class="card-body">
                     <div class="d-flex align-items-center">
                        <div class="">
                            <p class="mb-2 text-secondary">Kategoriya</p>
                            <div class="d-flex flex-wrap justify-content-start align-items-center">
                               <h5 class="mb-0 font-weight-bold">{{ new.ctg.name }}</h5>
                            </div>
                        </div>
                     </div>
                  </div>
               </div>
            </div>
            <div class="col-md-4">
            <div class="card">
                <div class="card-body">
                    <div class="d-flex align-items-center">
                        <div class="">
                            <p class="mb-2 text-secondary">Ko'rishlar soni</p>
                            <div class="d-flex flex-wrap justify-content-start align-items-center">
                               <h5 class="mb-0 font-weight-bold">{{ new.views }}</h5>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            </div>
            <div class="col-md-4">
            <div class="card">
                <div class="card-body">
                    <div class="d-flex align-items-center">
                        <div class="">
                           <p class="mb-2 text-secondary">Izohlar soni</p>
                           <div class="d-flex flex-wrap justify-content-start  align-items-center">
                              <h5 class="mb-0 font-weight-bold">{{ new.comments.count }}</h5>
                           </div>
                        </div>
                    </div>
                </div>
            </div>
            </div>

         </div>
      </div>




         <div class="table-editable">
            <table class="table table-bordered table-responsive-md table-striped text-center">
               <thead>
                  <tr>
                     <th>Key</th>
                     <th>Value</th>
                  </tr>
               </thead>
               <tbody>
                <tr>
                    <td style="max-width: 100px;">ID</td>
                    <td>{{ new.id }}</td>
                </tr>
                <tr>
                    <td style="max-width: 200px; min-width: 200px;">Title</td>
                    <td>{{ new.title }}</td>
                </tr>
                <tr>
                    <td style="max-width: 200px; min-width: 200px;">Qisqacha</td>
                    <td>
                        <button class="btn btn-outline-secondary mt-2 btn-sm" data-toggle="modal" data-target="#shortDesc">
                            <i class="fas fa-scroll"></i>

                            To'lliq o'qish
                        </button>
                    </td>
                </tr>
                <tr>
                    <td style="max-width: 200px; min-width: 200px;">To'lliq Mazmuni</td>
                    <td>
                        <button class="btn btn-outline-secondary mt-2 btn-sm" data-toggle="modal" data-target="#description">
                            <i class="fas fa-scroll"></i>
                            To'lliq o'qish
                        </button>
                    </td>
                </tr>
               <tr>
                   <td>Birinchi Rasm</td>
                   <td><img src="{{ new.image1.url }}" style="max-width:400px; max-height:400px;"></td>
               </tr>

                {% if new.image2 %}
                   <tr>
                       <td>Ikkinchi Rasm</td>
                       <td><img src="{{ new.image2.url }}"
                            style="max-width:400px; max-height:400px;">

                       </td>
                   </tr>
               {% endif %}



               </tbody>
            </table>
         </div>

         <hr>

       <nav aria-label="...">



       </nav>


      </div>

   </div>

<!-- short desc -->
<div class="modal fade" id="shortDesc" tabindex="-1" role="dialog" aria-labelledby="exampleModalCenterTitle" aria-hidden="true">
   <div class="modal-dialog modal-dialog-centered" role="document">
      <div class="modal-content">
         <div class="modal-header">
            <h5 class="modal-title" id="shortDescTitle">Yangilik haqida Qisqacha</h5>
            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
            <span aria-hidden="true">&times;</span>
            </button>
         </div>
         <div class="modal-body">
            {{ new.short_desc }}
         </div>
         <div class="modal-footer">
            <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
         </div>
      </div>
   </div>
</div>




<!-- to'lliq desc -->
<div class="modal fade" id="description" tabindex="-1" role="dialog" aria-labelledby="exampleModalCenterTitle" aria-hidden="true">
   <div class="modal-dialog modal-dialog-scrollable modal-dialog-centered" role="document">
      <div class="modal-content">
         <div class="modal-header">
            <h5 class="modal-title" id="descriptionTitle">To'lliq Mazmuni</h5>
            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
            <span aria-hidden="true">&times;</span>
            </button>
         </div>
         <div class="modal-body">

             {% for d in new.get_desc %}
             <p>{{ d }}</p>
             {% endfor %}

         </div>
         <div class="modal-footer">
            <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
         </div>
      </div>
   </div>
</div>



{% endif %}
{% endblock %}



